@if (isloading) {
  <app-modal-spinner></app-modal-spinner>
}
<div class="mt-4 p-4">
  
  <!-- Cabeçalho com Ajuda -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div class="d-flex align-items-center gap-2">
        <h1 class="mb-0">Lista de Despesas</h1>
        <i class="fa-regular fa-circle-question help-icon fs-4" 
           matTooltip="Gerencie todas as saídas financeiras da academia. Acompanhe contas pagas e pendentes."></i>
    </div>
    
    <div class="d-flex align-items-center">
        <a routerLink="novo" class="btn btn-primary">
            <i class="fa-solid fa-plus me-2"></i>Nova Despesa
        </a>
        <i class="fa-regular fa-circle-question help-icon ms-2" 
           matTooltip="Registrar uma nova conta a pagar (ex: Luz, Aluguel, Manutenção equipamentos)."></i>
    </div>
  </div>

  <table class="table table-striped table-hover border">
    <thead class="">
      <tr>
        <th>ID</th>
        <th>Descrição</th>
        <th>Valor (R$)</th>
        <th>Data de Vencimento</th>
        <th>
            Tipo
            <i class="fa-regular fa-circle-question help-icon ms-1 text-white" style="font-size: 0.8rem;"
               matTooltip="Classificação: Fixa (Recorrente) ou Variável (Esporádica)."></i>
        </th>
        <th>Obs</th>
        <th>
            Status
            <i class="fa-regular fa-circle-question help-icon ms-1 text-white" style="font-size: 0.8rem;"
               matTooltip="Indica se a despesa já foi quitada ou está em aberto."></i>
        </th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let despesa of despesas | paginate: { itemsPerPage: 8, currentPage: paginaAtual }">
        <td>{{ despesa.id }}</td>
        <td>{{ despesa.descricao }}</td>
        <td class="fw-bold text-danger">{{ despesa.valor | currency:'BRL' }}</td>
        <td>{{ despesa.data | date:'dd/MM/yyyy' }}</td>
        <td>
            <span class="badge bg-secondary">{{ despesa.tipo }}</span>
        </td> 
        <td><small class="text-muted">{{ despesa.observacao || '-' }}</small></td> 
        <td>
            <!-- CORREÇÃO AQUI: Usando 'paga' e 'pendente' em minúsculo conforme sua interface -->
            <span [ngClass]="{
                'badge bg-success': despesa.status === 'paga', 
                'badge bg-warning text-dark': despesa.status === 'pendente',
                
            }">
            <!-- 'badge bg-danger': despesa.status === 'atrasado' -->
                {{ despesa.status | titlecase }}
            </span>
        </td>
        <td>
          <a [routerLink]="['novo']" [queryParams]="{ id: despesa.id}" class="btn btn-sm btn-warning me-2"
             matTooltip="Editar dados desta despesa.">
             <i class="fa-solid fa-pen"></i>
          </a>
          <button class="btn btn-sm btn-danger" (click)="excluir(despesa.id)"
                  matTooltip="Excluir registro de despesa.">
              <i class="fa-solid fa-trash"></i>
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Paginação -->
  <div class="d-flex justify-content-between align-items-center mt-3">
      <pagination-controls class="pagination" (pageChange)="paginaAtual = $event" previousLabel="Anterior"
            nextLabel="Próximo"></pagination-controls>
      
      <i class="fa-regular fa-circle-question help-icon" 
         matTooltip="Navegue entre as páginas do histórico financeiro."></i>
  </div>
</div>